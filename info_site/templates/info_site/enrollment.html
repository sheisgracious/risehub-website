{% extends "info_site/base.html" %}
{% load static %}

{% block content %}
<section class="container" style="padding: 60px 0;">
    <div style="max-width: 800px; margin: 0 auto;">
        
        <!-- Header -->
        <div style="background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; padding: 40px; border-radius: 10px; margin-bottom: 30px; text-align: center;">
            <h2 style="margin-bottom: 10px;">Enroll in Digital Literacy 101</h2>
            {% comment %} <p style="margin: 0; opacity: 0.9;">Choose your preferred start date and join our learning community</p> {% endcomment %}
        </div>
        
        <!-- Messages -->
        {% if messages %}
        <div style="margin-bottom: 30px;">
            {% for message in messages %}
            <div style="padding: 15px; background-color: {% if message.tags == 'success' %}#d4edda{% elif message.tags == 'error' %}#f8d7da{% else %}#fff3cd{% endif %}; border: 1px solid {% if message.tags == 'success' %}#c3e6cb{% elif message.tags == 'error' %}#f5c6cb{% else %}#ffeaa7{% endif %}; border-radius: 5px; color: {% if message.tags == 'success' %}#155724{% elif message.tags == 'error' %}#721c24{% else %}#856404{% endif %};">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- Enrollment Form -->
        <div style="background: white; padding: 40px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
            <h3 style="color: var(--dark); margin-bottom: 25px;">
                <i class="fas fa-clipboard-check" style="color: var(--primary);"></i>
                Select Your Cohort
            </h3>
            
            <form method="post">
                {% csrf_token %}
                
                <div style="margin-bottom: 30px;">
                    <label style="display: block; margin-bottom: 15px; font-weight: 600; color: var(--text); font-size: 1.1rem;">
                        {{ form.cohort.label }}
                    </label>
                    
                    <!-- Custom Cohort Display -->
                    <div style="display: grid; gap: 15px;">
                        {% for choice in form.cohort.field.queryset %}
                        <label style="display: block; padding: 20px; border: 2px solid var(--gray); border-radius: 10px; cursor: pointer; transition: all 0.3s;" 
                               onmouseover="this.style.borderColor='var(--primary)'" 
                               onmouseout="if(!this.querySelector('input').checked) this.style.borderColor='var(--gray)'">
                            <input type="radio" name="cohort" value="{{ choice.id }}" 
                                   style="margin-right: 15px;" 
                                   onchange="this.parentElement.parentElement.querySelectorAll('label').forEach(l => l.style.borderColor='var(--gray)'); this.parentElement.style.borderColor='var(--primary)'; this.parentElement.style.backgroundColor='var(--light)';"
                                   {% if forloop.first %}checked{% endif %} />
                            <div style="display: inline-block; vertical-align: top;">
                                <strong style="color: var(--dark); font-size: 1.1rem;">{{ choice.name }}</strong>
                                <br>
                                <span style="color: var(--text-light);">
                                    <i class="fas fa-calendar"></i> 
                                    {{ choice.start_date|date:"M d, Y" }} - {{ choice.end_date|date:"M d, Y" }}
                                </span>
                                <br>
                                {% if choice.meeting_day and choice.meeting_time %}
                                <span style="color: var(--text-light);">
                                    <i class="fas fa-clock"></i> 
                                    {{ choice.meeting_day }}s at {{ choice.meeting_time|time:"h:i A" }}
                                </span>
                                <br>
                                {% endif %}
                                <span style="color: {% if choice.spots_remaining > 5 %}var(--success){% elif choice.spots_remaining > 0 %}var(--warning){% else %}var(--danger){% endif %}; font-weight: 600;">
                                    <i class="fas fa-users"></i> 
                                    {{ choice.spots_remaining }} spots remaining
                                </span>
                            </div>
                        </label>
                        {% endfor %}
                    </div>
                    
                    {% if form.cohort.errors %}
                    <div style="color: var(--danger); font-size: 0.9rem; margin-top: 10px;">
                        {{ form.cohort.errors }}
                    </div>
                    {% endif %}
                </div>
                
                <!-- Course Details -->
                <div style="background-color: var(--light); padding: 25px; border-radius: 10px; margin-bottom: 25px;">
                    <h4 style="color: var(--dark); margin-bottom: 15px;">Course Details:</h4>
                    <ul style="color: var(--text); line-height: 2;">
                        <li><i class="fas fa-check" style="color: var(--success); margin-right: 8px;"></i> 6 weeks of live instruction</li>
                        <li><i class="fas fa-check" style="color: var(--success); margin-right: 8px;"></i> Weekly flashcard assignments</li>
                        <li><i class="fas fa-check" style="color: var(--success); margin-right: 8px;"></i> One-on-one instructor support</li>
                        <li><i class="fas fa-check" style="color: var(--success); margin-right: 8px;"></i> Course completion certificate</li>
                        <li><i class="fas fa-check" style="color: var(--success); margin-right: 8px;"></i> Access to course materials</li>
                    </ul>
                </div>
                
                <!-- Price -->
                <div style="background-color: var(--light); padding: 25px; border-radius: 10px; margin-bottom: 25px; text-align: center;">
                    <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 5px;">Course Fee</div>
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary);">GHS 150</div>
                    <div style="color: var(--text-light); font-size: 0.9rem; margin-top: 5px;">One-time payment</div>
                </div>
                
                <!-- Terms -->
                <div style="margin-bottom: 25px; padding: 20px; border: 1px solid var(--gray); border-radius: 5px;">
                    <label style="display: flex; align-items: start; cursor: pointer;">
                        <input type="checkbox" name="agree_to_terms" required style="margin-right: 10px; margin-top: 3px;" />
                        <span style="color: var(--text); font-size: 0.95rem;">
                            I agree to the course terms and payment policy. I understand that payment is due within 3 days of enrollment and that I will be contacted for a technology assessment call.
                        </span>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 18px; font-size: 1.2rem;">
                    <i class="fas fa-check-circle"></i> Enroll Now
                </button>
            </form>
        </div>
        
        <!-- What Happens Next -->
        <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
            <h3 style="color: var(--dark); margin-bottom: 20px; text-align: center;">
                <i class="fas fa-route" style="color: var(--primary);"></i>
                What Happens Next?
            </h3>
            
            <div style="display: grid; gap: 20px;">
                <div style="display: flex; gap: 20px;">
                    <div style="flex-shrink: 0; width: 40px; height: 40px; background-color: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">1</div>
                    <div>
                        <strong style="color: var(--dark);">Enrollment Confirmation</strong>
                        <p style="color: var(--text-light); margin: 5px 0 0 0;">You'll receive an email confirming your enrollment within minutes.</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 20px;">
                    <div style="flex-shrink: 0; width: 40px; height: 40px; background-color: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">2</div>
                    <div>
                        <strong style="color: var(--dark);">Complete Payment</strong>
                        <p style="color: var(--text-light); margin: 5px 0 0 0;">You'll be directed to our payment page to complete your GHS 150 course fee.</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 20px;">
                    <div style="flex-shrink: 0; width: 40px; height: 40px; background-color: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">3</div>
                    <div>
                        <strong style="color: var(--dark);">Technology Assessment Call</strong>
                        <p style="color: var(--text-light); margin: 5px 0 0 0;">We'll contact you within 24 hours to schedule a free 15-minute assessment call.</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 20px;">
                    <div style="flex-shrink: 0; width: 40px; height: 40px; background-color: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">4</div>
                    <div>
                        <strong style="color: var(--dark);">Start Learning!</strong>
                        <p style="color: var(--text-light); margin: 5px 0 0 0;">Access your course materials and join your first class on the start date.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Help Section -->
        <div style="margin-top: 30px; text-align: center; padding: 25px; background-color: var(--light); border-radius: 10px;">
            <p style="color: var(--text); margin-bottom: 15px;">
                <strong>Have questions before enrolling?</strong>
            </p>
            <a href="{% url 'contact' %}" class="btn btn-outline" style="text-decoration: none;">
                <i class="fas fa-question-circle"></i> Contact Us
            </a>
        </div>
    </div>
</section>
{% endblock content %}